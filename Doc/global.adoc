:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
:imagesdir: img/
:toc:
:toc-placement!:

= Global

This file contains all the diagrams presenting the general functioning of the application

toc::[]

== Package

* Global package diagram

image::diagram-package-global.png?raw=true[Global package diagram]


== Class

* Global class diagram (simplified)

image::diagram-class-global-simplified.png?raw=true[Global class diagram (simplified)]


== Use case

* Global use case diagram

image::diagram-usecase-global.png?raw=true[Global use case diagram]

* Orange bubbles mean this is yet to be implemented. 

Tenant has two main interactions.
Firstly, Tenant must set his preferences in order to get an ordered list of apartments.
Based on the foregoing, he can compare two apartments using the SpiderPlot.
Secondly, Tenant can generate global database statistics.

A XOR constraint is implemented with the Generate database statistics. 
It means that this use case is used ONLY by one person at the time.


== Sequence Diagrams

* Diagram Sequence Value Function

image::diagram-sequence-valueFonction.png?raw=true[ValueFunction Sequence Diagram]

The goal of this sequence diagram is to show that the tenant has the possibility to ask some new questions in order to get a more refined list of apartments. 

List of classes/methods that will be implemented in java : 
`Orchestrator class` and its methods `showAOFU()`, `showLAG()`,`moreQuestionsClick()`,`addAnswerClick()` and `chooseApartmentClick()`.
AOFU methods : `askMoreQuestion()` and `adaptAVF()`.
LAG method : `updateAVF()`.

Some details on these class and methods are available below.

`Orchestrator` class : as its name shows, this class will be used to orchestrate the showing of the AOFU and LAG screen.
If the Tenant wants to refine his search, he can click on the button `askMoreQuestions` that will call the `moreQuestionsClick()` method. Then, the Orchestrator will use `showAOFU()` to request a supplementary question and call other AOFU methods in order to recalculate the AVF of the apartments in the list according to the new tenant's answer.
Afterwards, the Orchestrator calls the `showLAG()` to use its methods which are able to sort the list and display it to the tenant.

`askMoreQuestions()` and `adaptAVF()` methods : they're not already implemented in `AskOpinionForUtility`. 
The former will check if there are available questions and if yes, display one to the tenant (we didn't determind yet how is chosen the question). 
The latter method takes as parameters an avf and a criterion list. It will enable to recalculate avf apartments according to the given parameters. This method calls either `adaptBounds()` or `adaptWeight()` (both present in the `ApartmentValueFunction` class) depending on the length of crits list.
Indeed, if the crits list size equals 1, this means that the proposed question concerns only one criterion, consequently, we need to adapt bounds. However, if the size equals 2, we can understand that the question aimed to compare two criterias. Therefore, we need to adapt the criterion weights.

Once the tenant gets a new sorted list of apartments, if he's satisfied, he has the opportunity to select an apartment, otherwise, he isn't blocked and is free to do what he wants.


[%hardbreaks]
link:#toc[â¬† back to top]
